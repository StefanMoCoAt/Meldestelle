# ===================================================================
# Keycloak-Profilkonfiguration
# ===================================================================
# Zweck:
#  - Aktiviert OAuth2/JWT-Authentifizierung über Keycloak.
#  - Nutzt Spring Securitys oauth2ResourceServer zur validierten JWT-Prüfung.
# Hinweise:
#  - Innerhalb von Docker verweisen Standardwerte auf den Dienstnamen
#    "keycloak" (Port 8180). Außerhalb ggf. http://localhost:8180 verwenden.
#  - Werte können über Umgebungsvariablen überschrieben werden.
# ===================================================================

spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          # Issuer-URI für die JWT-Validierung
          #  - Docker-intern: http://keycloak:8180/realms/meldestelle
          #  - Extern (lokal): http://localhost:8180/realms/meldestelle
          issuer-uri: ${KEYCLOAK_ISSUER_URI:http://keycloak:8180/realms/meldestelle}
          # JWK-Set-URI zum Abruf der öffentlichen Schlüssel für die JWT-Signaturprüfung
          jwk-set-uri: ${KEYCLOAK_JWK_SET_URI:http://keycloak:8180/realms/meldestelle/protocol/openid-connect/certs}

# Keycloak-spezifische Konfiguration (optional, zur leichteren Nachvollziehbarkeit)
keycloak:
  # Interner Docker-Servicename; extern über Port 8180 erreichbar
  server-url: ${KEYCLOAK_SERVER_URL:http://keycloak:8180}
  issuer-uri: ${KEYCLOAK_ISSUER_URI:http://keycloak:8180/realms/meldestelle}
  jwk-set-uri: ${KEYCLOAK_JWK_SET_URI:http://keycloak:8180/realms/meldestelle/protocol/openid-connect/certs}
  realm: ${KEYCLOAK_REALM:meldestelle}
  resource: ${KEYCLOAK_CLIENT_ID:api-gateway}
  client-id: ${KEYCLOAK_CLIENT_ID:api-gateway}
  public-client: false
  bearer-only: true
