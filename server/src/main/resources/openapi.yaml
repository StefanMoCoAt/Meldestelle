openapi: 3.0.3
info:
  title: Meldestelle API
  description: API f√ºr die Meldestelle - Verwaltung von Veranstaltungen, Turnieren und Bewerbungen
  version: 1.0.0
  contact:
    name: Meldestelle Support
    email: support@mocode.at

servers:
  - url: http://localhost:8080
    description: Development server

paths:
  /health:
    get:
      summary: Health check
      description: Check if the service is running
      responses:
        '200':
          description: Service is healthy
          content:
            text/plain:
              schema:
                type: string
                example: "OK"

  /api:
    get:
      summary: API information
      description: Get basic API information
      responses:
        '200':
          description: API information
          content:
            text/plain:
              schema:
                type: string

  /api/persons:
    get:
      summary: Get all persons
      description: Retrieve a list of all persons in the system
      tags:
        - Persons
      responses:
        '200':
          description: List of persons
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Person'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    post:
      summary: Create new person
      description: Create a new person in the system
      tags:
        - Persons
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Person'
      responses:
        '201':
          description: Person created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Person'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/persons/{id}:
    get:
      summary: Get person by ID
      description: Retrieve a specific person by their UUID
      tags:
        - Persons
      parameters:
        - name: id
          in: path
          required: true
          description: Person UUID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Person found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Person'
        '400':
          description: Invalid UUID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Person not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      summary: Update person
      description: Update an existing person
      tags:
        - Persons
      parameters:
        - name: id
          in: path
          required: true
          description: Person UUID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Person'
      responses:
        '200':
          description: Person updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Person'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Person not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      summary: Delete person
      description: Delete a person from the system
      tags:
        - Persons
      parameters:
        - name: id
          in: path
          required: true
          description: Person UUID
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Person deleted successfully
        '400':
          description: Invalid UUID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Person not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/persons/oeps/{oepsSatzNr}:
    get:
      summary: Get person by OEPS number
      description: Retrieve a person by their OEPS Satz number
      tags:
        - Persons
      parameters:
        - name: oepsSatzNr
          in: path
          required: true
          description: OEPS Satz number
          schema:
            type: string
      responses:
        '200':
          description: Person found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Person'
        '400':
          description: Missing OEPS Satz number
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Person not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/persons/search:
    get:
      summary: Search persons
      description: Search for persons using a query string
      tags:
        - Persons
      parameters:
        - name: q
          in: query
          required: true
          description: Search query
          schema:
            type: string
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Person'
        '400':
          description: Missing search query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/persons/verein/{vereinId}:
    get:
      summary: Get persons by club ID
      description: Retrieve all persons belonging to a specific club
      tags:
        - Persons
      parameters:
        - name: vereinId
          in: path
          required: true
          description: Club UUID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of persons in the club
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Person'
        '400':
          description: Invalid UUID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    Person:
      type: object
      description: Person entity
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the person
        oepsSatzNr:
          type: string
          nullable: true
          description: OEPS Satz number
        nachname:
          type: string
          description: Last name
        vorname:
          type: string
          description: First name
        titel:
          type: string
          nullable: true
          description: Title (e.g., Dr., Prof.)
        geburtsdatum:
          type: string
          format: date
          nullable: true
          description: Date of birth
        geschlechtE:
          type: string
          nullable: true
          description: Gender
          enum: [MAENNLICH, WEIBLICH, DIVERS, UNBEKANNT]
        nationalitaet:
          type: string
          nullable: true
          description: Nationality (3-letter code)
        email:
          type: string
          format: email
          nullable: true
          description: Email address
        telefon:
          type: string
          nullable: true
          description: Phone number
        adresse:
          type: string
          nullable: true
          description: Address
        plz:
          type: string
          nullable: true
          description: Postal code
        ort:
          type: string
          nullable: true
          description: City
        stammVereinId:
          type: string
          format: uuid
          nullable: true
          description: Home club ID
        mitgliedsNummerIntern:
          type: string
          nullable: true
          description: Internal membership number
        letzteZahlungJahr:
          type: integer
          nullable: true
          description: Last payment year
        feiId:
          type: string
          nullable: true
          description: FEI ID
        istGesperrt:
          type: boolean
          description: Is person suspended
          default: false
        sperrGrund:
          type: string
          nullable: true
          description: Suspension reason
        rollen:
          type: array
          items:
            type: string
          description: Functional roles
        lizenzen:
          type: array
          items:
            type: object
          description: License information
        qualifikationenRichter:
          type: array
          items:
            type: string
          description: Judge qualifications
        qualifikationenParcoursbauer:
          type: array
          items:
            type: string
          description: Course builder qualifications
        istAktiv:
          type: boolean
          description: Is person active
          default: true
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
      required:
        - nachname
        - vorname

    Error:
      type: object
      description: Error response
      properties:
        error:
          type: string
          description: Error message
      required:
        - error

tags:
  - name: Persons
    description: Person management operations
